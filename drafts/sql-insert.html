<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="SQL INSERT文の実践例とわかりやすい解説ページ。体験しながら学べるIT用語辞典。">
  <title>【SQL実践例】INSERT文の使い方｜実践型IT用語辞典</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="container">
      <div class="hamburger-menu" id="hamburgerMenu" role="button" aria-label="メニューを開閉する" aria-controls="navMenu" aria-expanded="false">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </div>
      <div class="theme-switcher-container">
        <button id="themeSwitcher" aria-label="テーマを切り替える">🌙</button>
      </div>
      <h1>実践型IT用語辞典</h1>
      <p class="subtitle">「読んで終わり」じゃなく、「動かして理解する」</p>
      <nav id="navMenu">
        <ul>
          <li><a href="index.html#popular">人気用語</a></li>
          <li><a href="index.html#demo">体験デモ</a></li>
          <li><a href="index.html#new">新着用語</a></li>
          <li><a href="index.html#about">制作背景</a></li>
          <li><a href="form/request.html">用語リクエスト</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="breadcrumb">
      <a href="index.html">🏠 トップ</a> / <a href="index.html#popular">人気用語</a> / SQL INSERT文
    </div>
    <section class="learning-objectives">
      <h3>📚 このページで学べること</h3>
      <ul>
        <li>INSERT文の基本的な書き方</li>
        <li>実際にデータを挿入する体験</li>
        <li>エラーを回避する方法</li>
        <li>複数行を一度に挿入する方法</li>
      </ul>
    </section>

    <section>
      <h2>🤔 INSERT文とは？</h2>
      <p>INSERT文は、データベースのテーブルに新しいレコード（行）を追加するためのSQL文です。</p>
      <p>簡単に言うと、<strong>「データベースの表に新しい情報を書き込む」</strong>ための命令です。</p>
      
      <h3>基本的な書き方</h3>
      <div class="code-block">INSERT INTO テーブル名 (カラム1, カラム2, ...) VALUES (値1, 値2, ...);</div>
      
      <h3>具体例</h3>
      <div class="code-block">INSERT INTO users (name, age, email) VALUES ('田中太郎', 25, 'tanaka@example.com');</div>
      
      <div class="highlight">
        💡 <strong>ポイント：</strong> カラム名と値の順序は一致させる必要があります！
      </div>
    </section>

    <section>
      <h2>🧪 実際に体験してみよう！</h2>
      <p>下のフォームに情報を入力して、実際にINSERT文を実行してみましょう。</p>
      
      <div class="demo-area">
        <h3>ユーザー情報の追加</h3>
        
        <div class="input-group">
          <label for="userName">名前</label>
          <input type="text" id="userName" placeholder="田中太郎">
        </div>
        
        <div class="input-group">
          <label for="userAge">年齢</label>
          <input type="number" id="userAge" placeholder="25" min="1" max="150">
        </div>
        
        <div class="input-group">
          <label for="userEmail">メールアドレス</label>
          <input type="email" id="userEmail" placeholder="tanaka@example.com">
        </div>
        
        <button class="btn" onclick="insertUser()">📝 INSERT実行</button>
        <button class="btn btn-secondary" onclick="clearDatabase()">🗑️ データベースクリア</button>
      </div>
      
      <h3>生成されたSQL文</h3>
      <div class="output" id="sqlOutput">-- ここに生成されたSQL文が表示されます --</div>
      
      <h3>データベースの内容</h3>
      <div class="table-container">
        <table id="userTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>名前</th>
              <th>年齢</th>
              <th>メールアドレス</th>
              <th>登録日時</th>
            </tr>
          </thead>
          <tbody id="userTableBody">
            <tr>
              <td colspan="5" style="text-align: center; color: #666;">データがありません</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section>
      <h2>📝 INSERT文の応用</h2>
      
      <h3>複数行を一度に挿入</h3>
      <div class="code-block">INSERT INTO users (name, age, email) VALUES 
('田中太郎', 25, 'tanaka@example.com'),
('佐藤花子', 30, 'sato@example.com'),
('鈴木次郎', 28, 'suzuki@example.com');</div>
      
      <button class="btn" onclick="insertMultipleUsers()">📝 複数ユーザーを一度に追加</button>
      
      <h3>よくあるエラーと対処法</h3>
      <ul>
        <li><strong>NOT NULL制約エラー:</strong> 必須項目が入力されていない</li>
        <li><strong>データ型エラー:</strong> 数値項目に文字列を入力した</li>
        <li><strong>重複エラー:</strong> 既に存在するユニークな値を追加しようとした</li>
      </ul>
    </section>

    <section>
      <h2>🎯 実用的な使い方</h2>
      <p>実際の現場では、INSERT文は以下のような場面で使われます：</p>
      <ul>
        <li>会員登録システム</li>
        <li>商品登録システム</li>
        <li>ログデータの保存</li>
        <li>アンケート結果の保存</li>
      </ul>
      
      <div class="highlight">
        💡 <strong>プロのコツ：</strong> 本番環境では、必ずバックアップを取ってからデータを挿入しましょう！
      </div>
    </section>

    <section class="related-terms">
      <h2>🔗 関連用語</h2>
      <ul>
        <li><a href="sql-select.html">🔍 SELECT文 - データを取得する</a></li>
        <li><a href="sql-update.html">✏️ UPDATE文 - データを更新する</a></li>
        <li><a href="sql-delete.html">🗑️ DELETE文 - データを削除する</a></li>
        <li><a href="database.html">🗄️ データベース - データを保存する仕組み</a></li>
      </ul>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="footer-links">
        <a href="form/request.html">用語リクエスト</a>
        <a href="rss.xml" target="_blank">RSS</a>
      </div>
      <div class="sns-share">
        <a href="#" id="shareTwitter" target="_blank" aria-label="Twitterでシェア">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
        </a>
        <a href="#" id="shareFacebook" target="_blank" aria-label="Facebookでシェア">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>
        </a>
      </div>
      <p>&copy; 2025 実践型IT用語辞典 | Jissen IT</p>
    </div>
  </footer>

  <script>
    // Hamburger Menu
    document.getElementById('hamburgerMenu').addEventListener('click', function() {
      document.getElementById('navMenu').classList.toggle('active');
    });

    // Theme Switcher
    const themeSwitcher = document.getElementById('themeSwitcher');
    const body = document.body;

    // 1. localStorageからテーマ設定を読み込む
    const currentTheme = localStorage.getItem('theme');

    // 2. テーマを適用する関数
    const applyTheme = (theme) => {
      if (theme === 'dark') {
        body.classList.add('dark-mode');
        themeSwitcher.textContent = '☀️';
      } else {
        body.classList.remove('dark-mode');
        themeSwitcher.textContent = '🌙';
      }
    };

    // 3. 初期テーマの設定
    if (currentTheme) {
      applyTheme(currentTheme);
    } else {
      // localStorageに設定がない場合はOSの設定に従う
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      applyTheme(prefersDark ? 'dark' : 'light');
    }

    // 4. スイッチクリック時の動作
    themeSwitcher.addEventListener('click', () => {
      let newTheme;
      if (body.classList.contains('dark-mode')) {
        newTheme = 'light';
      } else {
        newTheme = 'dark';
      }
      applyTheme(newTheme);
      localStorage.setItem('theme', newTheme);
    });

    // SQL INSERT体験デモ (既存のものをそのまま残す)
    let users = [];
    let nextId = 1;

    function insertUser() {
      const name = document.getElementById('userName').value.trim();
      const age = document.getElementById('userAge').value;
      const email = document.getElementById('userEmail').value.trim();
      
      // バリデーション
      if (!name) {
        alert('名前を入力してください');
        return;
      }
      
      if (!age || age < 1 || age > 150) {
        alert('有効な年齢を入力してください（1-150）');
        return;
      }
      
      if (!email || !email.includes('@')) {
        alert('有効なメールアドレスを入力してください');
        return;
      }
      
      // 重複チェック
      if (users.find(user => user.email === email)) {
        alert('同じメールアドレスのユーザーが既に存在します');
        return;
      }
      
      // ユーザーを追加
      const user = {
        id: nextId++,
        name,
        age: parseInt(age),
        email,
        createdAt: new Date().toLocaleString('ja-JP')
      };
      
      users.push(user);
      
      // SQL文を表示
      const sqlOutput = document.getElementById('sqlOutput');
      sqlOutput.textContent = `INSERT INTO users (name, age, email) VALUES ('${name}', ${age}, '${email}');
-- ✅ 実行成功: 1行が挿入されました
-- 新しいユーザー ID: ${user.id}`;
      
      // テーブルを更新
      updateUserTable();
      
      // フォームをクリア
      document.getElementById('userName').value = '';
      document.getElementById('userAge').value = '';
      document.getElementById('userEmail').value = '';
    }
    
    function insertMultipleUsers() {
      const sampleUsers = [
        { name: '田中太郎', age: 25, email: 'tanaka@example.com' },
        { name: '佐藤花子', age: 30, email: 'sato@example.com' },
        { name: '鈴木次郎', age: 28, email: 'suzuki@example.com' }
      ];
      
      let addedCount = 0;
      
      sampleUsers.forEach(userData => {
        // 重複チェック
        if (!users.find(user => user.email === userData.email)) {
          const user = {
            id: nextId++,
            name: userData.name,
            age: userData.age,
            email: userData.email,
            createdAt: new Date().toLocaleString('ja-JP')
          };
          users.push(user);
          addedCount++;
        }
      });
      
      if (addedCount > 0) {
        // SQL文を表示
        const sqlOutput = document.getElementById('sqlOutput');
        sqlOutput.textContent = `INSERT INTO users (name, age, email) VALUES \n('田中太郎', 25, 'tanaka@example.com'),\n('佐藤花子', 30, 'sato@example.com'),\n('鈴木次郎', 28, 'suzuki@example.com');\n-- ✅ 実行成功: ${addedCount}行が挿入されました`;
        
        // テーブルを更新
        updateUserTable();
      } else {
        alert('追加可能なユーザーがありません（重複のため）');
      }
    }
    
    function clearDatabase() {
      if (confirm('データベースの内容をすべて削除しますか？')) {
        users = [];
        nextId = 1;
        updateUserTable();
        
        const sqlOutput = document.getElementById('sqlOutput');
        sqlOutput.textContent = '-- データベースがクリアされました';
      }
    }
    
    function updateUserTable() {
      const tbody = document.getElementById('userTableBody');
      
      if (users.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #666;">データがありません</td></tr>';
        return;
      }
      
      tbody.innerHTML = users.map(user => `
        <tr>
          <td>${user.id}</td>
          <td>${user.name}</td>
          <td>${user.age}</td>
          <td>${user.email}</td>
          <td>${user.createdAt}</td>
        </tr>
      `).join('');
    }
  </script>
</body>
</html> 